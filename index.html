<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pregnancy Control Center</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <link href="https://fonts.googleapis.com/css2?family=Assistant:wght@300;400;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
</head>
<body class="bg-[#FDFCFB] text-slate-800 font-['Assistant'] pb-24">

    <div class="max-w-5xl mx-auto p-4 md:p-8 space-y-6">
        <header class="card-gradient p-8 rounded-[40px] text-white shadow-xl relative overflow-hidden">
            <div class="flex flex-col md:flex-row justify-between items-center gap-6 relative z-10">
                <div class="text-center md:text-right">
                    <h1 class="text-4xl font-black mb-2 tracking-tight italic">המסע של ענבר ומשה</h1>
                    <div id="display-weeks" class="text-2xl font-bold bg-white/20 inline-block px-5 py-2 rounded-full backdrop-blur-md">טוען...</div>
                    <div class="mt-4 text-sm opacity-90 leading-relaxed font-semibold">
                        <p>תאריך לידה משוער: <span id="due-date" class="underline">--</span></p>
                        <p>מזל הבייבי: <span id="zodiac-sign">--</span></p>
                    </div>
                    <button onclick="shareToWhatsApp()" class="mt-5 flex items-center gap-2 bg-emerald-500 hover:bg-emerald-600 px-6 py-3 rounded-2xl text-sm font-bold transition-all shadow-lg active:scale-95">
                        <i data-lucide="share-2" class="w-4 h-4"></i> שלח סיכום מצב לענבר
                    </button>
                </div>
                <div class="flex flex-col items-center bg-white/10 p-6 rounded-[35px] backdrop-blur-md border border-white/20 min-w-[180px]">
                    <div id="fruit-emoji" class="text-7xl mb-2 animate-bounce">🌱</div>
                    <div id="fruit-name" class="text-xs font-bold uppercase tracking-widest text-pink-100 italic">מתחברים לנתונים...</div>
                    <div class="mt-3 text-center border-t border-white/20 pt-3 w-full">
                        <span id="days-left" class="text-4xl font-black italic">--</span>
                        <p class="text-[10px] uppercase font-bold opacity-80">ימים למפגש המרגש</p>
                    </div>
                </div>
            </div>
        </header>

        <section class="card p-8 grid grid-cols-1 md:grid-cols-3 gap-8 items-end">
            <div class="space-y-2">
                <label class="label-sm text-slate-400 font-bold italic">📅 תאריך וסת אחרון</label>
                <input type="date" id="lmp-date" class="input-field w-full" onchange="handleLMPChange()">
            </div>
            <div class="grid grid-cols-2 gap-4">
                <div class="space-y-2">
                    <label class="label-sm text-slate-400 font-bold italic">שבוע הריון</label>
                    <input type="number" id="manual-w" class="input-field w-full" oninput="handleManualChange()">
                </div>
                <div class="space-y-2">
                    <label class="label-sm text-slate-400 font-bold italic">ימים</label>
                    <input type="number" id="manual-d" class="input-field w-full" oninput="handleManualChange()">
                </div>
            </div>
            <div class="text-center text-[10px] text-slate-300 italic font-medium">
                השבועות והימים מתעדכנים אוטומטית לפי התאריך. ניתן לערוך ידנית לדיוק מקסימלי.
            </div>
        </section>

        <nav class="flex overflow-x-auto gap-2 border-b border-slate-200 no-scrollbar py-2 sticky top-0 bg-[#FDFCFB]/90 backdrop-blur-md z-40">
            <button onclick="showTab('tasks')" class="tab-btn active" id="btn-tasks">בדיקות ולו"ז</button>
            <button onclick="showTab('procurement')" class="tab-btn" id="btn-proc">רכש ותקציב</button>
            <button onclick="showTab('hospital')" class="tab-btn" id="btn-hosp">תיק לידה</button>
            <button onclick="showTab('emergency')" class="tab-btn" id="btn-emer">אנשי קשר</button>
        </nav>

        <div id="tab-tasks" class="tab-content space-y-6">
            <div class="grid md:grid-cols-3 gap-6" id="tasks-grid">
                <div class="space-y-4">
                    <h3 class="trim-title bg-emerald-50 text-emerald-700 italic font-black">טרימסטר 1</h3>
                    <div id="list-1" class="space-y-3"></div>
                </div>
                <div class="space-y-4">
                    <h3 class="trim-title bg-blue-50 text-blue-700 italic font-black">טרימסטר 2</h3>
                    <div id="list-2" class="space-y-3"></div>
                </div>
                <div class="space-y-4">
                    <h3 class="trim-title bg-purple-50 text-purple-700 italic font-black">טרימסטר 3</h3>
                    <div id="list-3" class="space-y-3"></div>
                </div>
            </div>
            <button onclick="openSelector('task')" class="btn-save w-full">+ הוספת בדיקה חדשה</button>
        </div>

        <div id="tab-procurement" class="tab-content hidden space-y-4">
            <div class="card p-8">
                <div class="flex justify-between items-center mb-8 border-b pb-6">
                    <h3 class="font-black text-xl">ניהול סל קניות</h3>
                    <div class="text-left">
                        <span class="text-[11px] text-slate-400 block font-bold uppercase">סה"כ הוצאות בפועל</span>
                        <span id="total-spent" class="text-4xl font-black text-emerald-600">₪0</span>
                    </div>
                </div>
                <div class="overflow-x-auto">
                    <table class="w-full text-right text-sm">
                        <thead class="bg-slate-50">
                            <tr>
                                <th class="p-4 rounded-r-2xl">מוצר</th>
                                <th class="p-4">מחיר שוק</th>
                                <th class="p-4">כמה שילמנו</th>
                                <th class="p-4">איפה כדאי?</th>
                                <th class="p-4 rounded-l-2xl"></th>
                            </tr>
                        </thead>
                        <tbody id="proc-body"></tbody>
                    </table>
                </div>
                <button onclick="openSelector('proc')" class="btn-save w-full mt-8 bg-pink-500 hover:bg-pink-600">+ הוסף מוצר (מרשימה או ידני)</button>
            </div>
        </div>

        <div id="tab-hospital" class="tab-content hidden grid md:grid-cols-2 gap-8">
            <div class="card p-8 bg-pink-50/20 border-pink-100 shadow-inner">
                <h3 class="font-black mb-6 flex items-center gap-2 text-pink-700 text-lg">👜 עבור ענבר</h3>
                <div id="bag-inbar" class="space-y-3"></div>
                <button onclick="openSelector('bag-inbar')" class="btn-add-mini mt-6">+ הוסף פריט</button>
            </div>
            <div class="card p-8 bg-blue-50/20 border-blue-100 shadow-inner">
                <h3 class="font-black mb-6 flex items-center gap-2 text-blue-700 text-lg">👶 עבור הבייבי</h3>
                <div id="bag-baby" class="space-y-3"></div>
                <button onclick="openSelector('bag-baby')" class="btn-add-mini mt-6">+ הוסף פריט</button>
            </div>
        </div>

        <div id="tab-emergency" class="tab-content hidden space-y-6">
            <div id="emergency-list" class="grid md:grid-cols-2 gap-4"></div>
            <button onclick="addEmergencyItem()" class="btn-save w-full bg-slate-800">+ הוסף איש קשר חדש</button>
        </div>
    </div>

    <div id="selector-modal" class="fixed inset-0 bg-slate-900/60 backdrop-blur-sm hidden z-50 flex items-center justify-center p-4">
        <div class="bg-white rounded-[40px] p-8 max-w-lg w-full shadow-2xl transition-all scale-up">
            <h3 class="text-2xl font-black mb-6">הוספת פריט</h3>
            <div class="space-y-5">
                <select id="suggestion-select" class="input-field w-full" onchange="toggleManualInput(this.value)"></select>
                <div id="manual-input-container" class="hidden border-t pt-4">
                    <input type="text" id="manual-entry" class="input-field w-full" placeholder="הקלד כאן את שם הפריט...">
                </div>
                <button onclick="submitSelection()" class="btn-save w-full bg-pink-500 py-4 shadow-lg text-lg">הוסף לרשימה</button>
                <button onclick="closeSelector()" class="w-full text-slate-400 text-xs font-bold uppercase tracking-widest">ביטול</button>
            </div>
        </div>
    </div>

    <div id="help-modal" class="fixed inset-0 bg-slate-900/40 backdrop-blur-sm hidden z-50 flex items-center justify-center p-4">
        <div class="bg-white p-10 rounded-[40px] max-w-md w-full shadow-2xl border-t-8 border-pink-400">
            <h4 id="help-title" class="font-black text-2xl text-slate-800 mb-4 italic"></h4>
            <p id="help-desc" class="text-slate-600 leading-relaxed text-lg font-medium"></p>
            <button onclick="document.getElementById('help-modal').classList.add('hidden')" class="btn-secondary w-full mt-8 py-3 font-black">הבנתי, תודה</button>
        </div>
    </div>

    <script src="script.js"></script>
</body>
</html>
